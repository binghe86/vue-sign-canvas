(function(t){function e(e){for(var n,a,r=e[0],c=e[1],l=e[2],u=0,f=[];u<r.length;u++)a=r[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);h&&h(e);while(f.length)f.shift()();return s.push.apply(s,l||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],n=!0,r=1;r<i.length;r++){var c=i[r];0!==o[c]&&(n=!1)}n&&(s.splice(e--,1),t=a(a.s=i[0]))}return t}var n={},o={index:0},s=[];function a(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=n,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/vue-sign-canvas/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var h=c;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("c31f")},"5e45":function(t,e,i){},c31f:function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d");var n=i("2b0e"),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("h2",{staticClass:"title"},[t._v("Vue Sign Canvas 电子签名板")]),i("sign-canvas",{ref:"SignCanvas",staticClass:"sign-canvas",attrs:{options:t.options},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t.value?i("img",{staticClass:"view-image",attrs:{src:t.value,width:"150",height:"150"}}):t._e(),i("div",{staticClass:"config"},[i("ul",{staticClass:"ul-config"},[i("li",{staticClass:"li-c"},[i("span",{staticClass:"item-label"},[t._v("书写速度:")]),i("span",{staticClass:"item-content"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.options.isSign,expression:"options.isSign"}],attrs:{name:"isSign"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.options,"isSign",e.target.multiple?i:i[0])}}},[i("option",{domProps:{value:!0}},[t._v("签名")]),i("option",{domProps:{value:!1}},[t._v("写字")])])])]),i("li",{staticClass:"li-c"},[i("span",{staticClass:"item-label"},[t._v("显示边框/网格:")]),i("span",{staticClass:"item-content"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.options.isShowBorder,expression:"options.isShowBorder"}],attrs:{name:"isSign"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.options,"isShowBorder",e.target.multiple?i:i[0])}}},[i("option",{domProps:{value:!0}},[t._v("显示")]),i("option",{domProps:{value:!1}},[t._v("不显示")])])])]),i("li",{staticClass:"li-c"},[i("span",{staticClass:"item-label"},[t._v("下笔宽度:")]),i("span",{staticClass:"item-content"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.options.writeWidth,expression:"options.writeWidth"}],attrs:{type:"number"},domProps:{value:t.options.writeWidth},on:{input:function(e){e.target.composing||t.$set(t.options,"writeWidth",e.target.value)}}})])]),i("li",{staticClass:"li-c"},[i("span",{staticClass:"item-label"},[t._v("线条的边缘类型:")]),i("span",{staticClass:"item-content"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.options.lineCap,expression:"options.lineCap"}],attrs:{name:"lineCap"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.options,"lineCap",e.target.multiple?i:i[0])}}},[i("option",{attrs:{value:"butt"}},[t._v("平直的边缘")]),i("option",{attrs:{value:"round"}},[t._v("圆形线帽")]),i("option",{attrs:{value:"square"}},[t._v("正方形线帽")])])])]),i("li",{staticClass:"li-c"},[i("span",{staticClass:"item-label"},[t._v("线条交汇时边角的类型:")]),i("span",{staticClass:"item-content"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.options.lineJoin,expression:"options.lineJoin"}],attrs:{name:"lineCap"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.options,"lineJoin",e.target.multiple?i:i[0])}}},[i("option",{attrs:{value:"bevel"}},[t._v("创建斜角")]),i("option",{attrs:{value:"round"}},[t._v("创建圆角")]),i("option",{attrs:{value:"miter"}},[t._v("创建尖角")])])])]),i("li",{staticClass:"li-c"},[i("span",{staticClass:"item-label"},[t._v("画笔颜色:")]),i("span",{staticClass:"item-content"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.options.writeColor,expression:"options.writeColor"}],attrs:{type:"color"},domProps:{value:t.options.writeColor},on:{input:function(e){e.target.composing||t.$set(t.options,"writeColor",e.target.value)}}})])]),i("li",{staticClass:"li-c"},[i("span",{staticClass:"item-label"},[t._v("背景色:")]),i("span",{staticClass:"item-content"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.options.bgColor,expression:"options.bgColor"}],attrs:{type:"color"},domProps:{value:t.options.bgColor},on:{input:function(e){e.target.composing||t.$set(t.options,"bgColor",e.target.value)}}})])])])]),i("div",{staticClass:"sign-btns"},[i("span",{attrs:{id:"clear"},on:{click:function(e){return t.canvasClear()}}},[t._v("清空")]),i("span",{attrs:{id:"save"},on:{click:function(e){return t.saveAsImg()}}},[t._v("保存")]),i("span",{attrs:{id:"save"},on:{click:function(e){return t.downloadSignImg()}}},[t._v("下载")])])],1)},s=[],a=(i("7f7f"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("canvas",{ref:t.domId,staticClass:"app-sign-canvas",attrs:{id:t.domId},on:{mousedown:function(e){return e.preventDefault(),e.stopPropagation(),t.handleMousedown(e)},mousemove:function(e){return e.preventDefault(),e.stopPropagation(),t.handleMousemove(e)},mouseup:function(e){return e.preventDefault(),e.stopPropagation(),t.handleMouseup(e)},mouseleave:function(e){return e.preventDefault(),e.stopPropagation(),t.handleMouseleave(e)},touchstart:function(e){return e.preventDefault(),e.stopPropagation(),t.handleTouchstart(e)},touchmove:function(e){return e.preventDefault(),e.stopPropagation(),t.handleTouchmove(e)},touchend:function(e){return e.preventDefault(),e.stopPropagation(),t.handleTouchend(e)}}},[t._v("\n    您的浏览器不支持canvas技术,请升级浏览器!\n")])}),r=[],c=(i("6b54"),{name:"SignCanvas",model:{value:"image",event:"confirm"},props:{image:{required:!1,type:[String],default:null},options:{required:!1,type:[Object],default:function(){return null}}},data:function(){return{value:null,domId:"sign-canvas-".concat(Math.random().toString(36).substr(2)),canvas:null,context:null,config:{lastWriteSpeed:1,lastWriteWidth:2,lineCap:"round",lineJoin:"round",canvasWidth:600,canvasHeight:600,isShowBorder:!0,bgColor:"#fcc",borderWidth:1,borderColor:"#ff787f",writeWidth:5,maxWriteWidth:30,minWriteWidth:5,writeColor:"#101010",isSign:!1,imgType:"png"}}},mounted:function(){this.init()},watch:{options:{handler:function(){this.init()},deep:!0}},methods:{init:function(){this.canvas=document.getElementById(this.domId),this.context=this.canvas.getContext("2d"),this.canvas.style.backgorund=this.config.bgColor,this.canvas.height=this.config.canvasWidth,this.canvas.width=this.config.canvasHeight;var t=this.options;if(t)for(var e in t)this.config[e]=t[e];console.log(this.config),this.canvasInit(),this.canvasClear()},setLineWidth:function(){var t=(new Date).getTime(),e=t-this.config.lastWriteTime;this.config.lastWriteTime=t;var i=this.config.minWriteWidth+(this.config.maxWriteWidth-this.config.minWriteWidth)*e/30;i<this.config.minWriteWidth?i=this.config.minWriteWidth:i>this.config.maxWriteWidth&&(i=this.config.maxWriteWidth),i=i.toFixed(2),this.config.isSign?this.context.lineWidth=this.config.writeWidth:this.context.lineWidth=this.config.lastWriteWidth=this.config.lastWriteWidth/4*3+i/4},writing:function(t){this.context.beginPath(),this.context.moveTo(this.config.lastPoint.x,this.config.lastPoint.y),this.context.lineTo(t.x,t.y),this.setLineWidth(),this.context.stroke(),this.config.lastPoint=t,this.context.closePath()},writeContextStyle:function(){this.context.beginPath(),this.context.strokeStyle=this.config.writeColor,this.context.lineCap=this.config.lineCap,this.context.lineJoin=this.config.lineJoin},writeBegin:function(t){this.config.isWrite=!0,this.config.lastWriteTime=(new Date).getTime(),this.config.lastPoint=t,this.writeContextStyle()},writeEnd:function(t){this.config.isWrite=!1,this.config.lastPoint=t,this.saveAsImg()},canvasClear:function(){this.context.save(),this.context.strokeStyle=this.config.writeColor,this.context.clearRect(0,0,this.config.canvasWidth,this.config.canvasHeight),this.context.beginPath();var t=this.config.borderWidth/2;this.config.isShowBorder&&(this.context.moveTo(t,t),this.context.lineTo(this.config.canvasWidth-t,t),this.context.lineTo(this.config.canvasWidth-t,this.config.canvasHeight-t),this.context.lineTo(t,this.config.canvasHeight-t),this.context.closePath(),this.context.lineWidth=this.config.borderWidth,this.context.strokeStyle=this.config.borderColor,this.context.stroke()),this.config.isShowBorder&&!this.config.isSign&&(this.context.moveTo(0,0),this.context.lineTo(this.config.canvasWidth,this.config.canvasHeight),this.context.lineTo(this.config.canvasWidth,this.config.canvasHeight/2),this.context.lineTo(this.config.canvasWidth,this.config.canvasHeight/2),this.context.lineTo(0,this.config.canvasHeight/2),this.context.lineTo(0,this.config.canvasHeight),this.context.lineTo(this.config.canvasWidth,0),this.context.lineTo(this.config.canvasWidth/2,0),this.context.lineTo(this.config.canvasWidth/2,this.config.canvasHeight),this.context.stroke()),this.$emit("confirm",null),this.context.restore()},saveAsImg:function(){var t=new Image;return t.src=this.canvas.toDataURL("image/".concat(this.config.imgType)),this.$emit("confirm",t.src),t.src},canvasInit:function(){this.canvas.width=this.config.canvasWidth,this.canvas.height=this.config.canvasHeight,this.config.emptyCanvas=this.canvas.toDataURL("image/".concat(this.config.imgType))},handleMousedown:function(t){this.writeBegin({x:t.offsetX||t.clientX,y:t.offsetY||t.clientY})},handleMousemove:function(t){this.config.isWrite&&this.writing({x:t.offsetX,y:t.offsetY})},handleMouseup:function(t){this.writeEnd({x:t.offsetX,y:t.offsetY})},handleMouseleave:function(t){this.config.isWrite=!1,this.config.lastPoint={x:t.offsetX,y:t.offsetY}},handleTouchstart:function(t){var e=t.targetTouches[0],i=e.clientX?e.clientX-this.getRect().left:e.pageX-this.offset(e.target,"left"),n=e.clientY?e.clientY-this.getRect().top:e.pageY-this.offset(e.target,"top");console.log(i,n),this.writeBegin({x:i,y:n})},handleTouchmove:function(t){var e=t.targetTouches[0],i=e.clientX?e.clientX-this.getRect().left:e.pageX-this.offset(e.target,"left"),n=e.clientY?e.clientY-this.getRect().top:e.pageY-this.offset(e.target,"top");this.config.isWrite&&this.writing({x:i,y:n})},handleTouchend:function(t){var e=t.targetTouches,i=t.changedTouches,n=e&&e.length&&e[0]||i&&i.length&&i[0],o=n.clientX?n.clientX-this.getRect().left:n.pageX-this.offset(n.target,"left"),s=n.clientY?n.clientY-this.getRect().top:n.pageY-this.offset(n.target,"top");this.writeEnd({x:o,y:s})},downloadSignImg:function(t){var e=document.getElementById(this.domId),i=e.toDataURL("image/png");this.saveFile(i,t?"".concat(t,".").concat(this.config.imgType):"".concat(Date.parse(new Date),".").concat(this.config.imgType))},saveFile:function(t,e){var i=document.createElementNS("http://www.w3.org/1999/xhtml","a");i.href=t,i.download=e;var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(n)},getRect:function(){return this.$refs[this.domId].getBoundingClientRect()},offset:function(t,e){var i="offset"+e[0].toUpperCase()+e.substring(1),n=t[i],o=t.offsetParent;while(null!=o)n+=o[i],o=o.offsetParent;return n}}}),l=c,h=i("2877"),u=Object(h["a"])(l,a,r,!1,null,null,null),f=u.exports;f.install=function(t){t.component(f.name,f)};var g=f,v={components:{SignCanvas:g},data:function(){return{value:null,options:{lastWriteSpeed:1,lastWriteWidth:2,lineCap:"round",lineJoin:"bevel",canvasWidth:350,canvasHeight:370,isShowBorder:!0,bgColor:"#fcc",borderWidth:1,borderColor:"#ff787f",writeWidth:5,maxWriteWidth:30,minWriteWidth:5,writeColor:"#101010",isSign:!0,imgType:"png"}}},methods:{canvasClear:function(){this.$refs.SignCanvas.canvasClear()},saveAsImg:function(){var t=this.$refs.SignCanvas.saveAsImg();alert("image 的base64：".concat(t))},downloadSignImg:function(){this.$refs.SignCanvas.downloadSignImg()}}},p=v,d=(i("e780"),Object(h["a"])(p,o,s,!1,null,null,null)),m=d.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(m)}}).$mount("#app")},e780:function(t,e,i){"use strict";var n=i("5e45"),o=i.n(n);o.a}});
//# sourceMappingURL=index.aab93da1.js.map